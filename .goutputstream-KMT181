'''
Sentence mining app inspired by Giovanni Smith's Sentence Mining Scripts

Goal is to use python automation and perform the following functions:
1. record audio and take screenshot
a. record audio using sharex key command
-- better if you can use PACT style pop out to select the time
b. take screenshot key command at either begin or end of clip

2. paste audio and screenshot from windows clipboard
-- win+v 
'''

import keyboard
import time
import pyautogui

is_recording = False
vlc_window = None

# find VLC window
for window in pyautogui.getAllWindows():
    if "VLC" in window.title:
        vlc_window = window
if vlc_window is None:
    print("Could not find VLC")
    exit()


def start_stop_recording():
    vlc_window.activate()
    time.sleep(0.350)
    
    global is_recording
 
    if not is_recording:
        keyboard.send("space") # start/stop recording
        time.sleep(0.300)
        keyboard.send("ctrl+alt+r")  # start recording
        is_recording = True
        time.sleep(0.450)
        keyboard.send("ctrl+alt+s")  # grab screenshot
    else:
        keyboard.send("ctrl+alt+r")  # stop recording
        time.sleep(0.350)  # wait 300ms
        keyboard.send("space") 
        is_recording = False

keyboard.add_hotkey("ctrl+shift+f1", start_stop_recording)
keyboard.wait()

